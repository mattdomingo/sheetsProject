-- Clear the target table before inserting new data
TRUNCATE TABLE `sheets_base_schema.amazon_selling_partner__order_items`;

-- Insert data from the source table into the target table
INSERT INTO `sheets_base_schema.amazon_selling_partner__order_items` (
  `source_relation`,
  `amazon_order_id`,
  `order_item_id`,
  `asin`,
  `seller_sku`,
  `title`,
  `product_info_detail_number_of_items`,
  `scheduled_delivery_start_date`,
  `scheduled_delivery_end_date`,
  `quantity_ordered`,
  `quantity_shipped`,
  `item_price_amount`,
  `item_price_currency_code`,
  `item_tax_amount`,
  `item_tax_currency_code`,
  `shipping_discount_amount`,
  `shipping_discount_currency_code`,
  `shipping_discount_tax_amount`,
  `shipping_discount_tax_currency_code`,
  `shipping_price_amount`,
  `shipping_price_currency_code`,
  `shipping_tax_amount`,
  `shipping_tax_currency_code`,
  `promotion_discount_amount`,
  `promotion_discount_currency_code`,
  `promotion_discount_tax_amount`,
  `promotion_discount_tax_currency_code`,
  `condition_id`,
  `condition_note`,
  `condition_subtype_id`,
  `buyer_requested_cancel_reason`,
  `is_buyer_requested_cancel`,
  `deemed_reseller_category`,
  `ioss_number`,
  `is_gift`,
  `is_transparency`,
  `is_serial_number_required`,
  `store_chain_store_id`,
  `tax_collection_model`,
  `tax_collection_responsible_party`,
  `order_purchase_date`,
  `order_total_amount`,
  `order_total_currency_code`,
  `order_status`,
  `marketplace_id`,
  `order_total_number_of_items_shipped`,
  `order_total_number_of_items_unshipped`,
  `count_promotions_used`
  --`item_name`,
  --`display_name`,
  --`brand`,
  --`color`,
  --`size`,
  --`style`,
  --`product_type`,
  --`package_quantity`,
  --`item_classification`
)
SELECT
  `source_relation`,
  `amazon_order_id`,
  `order_item_id`,
  `asin`,
  `seller_sku`,
  `title`,
  `product_info_detail_number_of_items`,
  `scheduled_delivery_start_date`,
  `scheduled_delivery_end_date`,
  `quantity_ordered`,
  `quantity_shipped`,
  `item_price_amount`,
  `item_price_currency_code`,
  `item_tax_amount`,
  `item_tax_currency_code`,
  `shipping_discount_amount`,
  `shipping_discount_currency_code`,
  `shipping_discount_tax_amount`,
  `shipping_discount_tax_currency_code`,
  `shipping_price_amount`,
  `shipping_price_currency_code`,
  `shipping_tax_amount`,
  `shipping_tax_currency_code`,
  `promotion_discount_amount`,
  `promotion_discount_currency_code`,
  `promotion_discount_tax_amount`,
  `promotion_discount_tax_currency_code`,
  `condition_id`,
  `condition_note`,
  `condition_subtype_id`,
  `buyer_requested_cancel_reason`,
  `is_buyer_requested_cancel`,
  `deemed_reseller_category`,
  `ioss_number`,
  `is_gift`,
  `is_transparency`,
  `is_serial_number_required`,
  `store_chain_store_id`,
  `tax_collection_model`,
  `tax_collection_responsible_party`,
  `order_purchase_date`,
  `order_total_amount`,
  `order_total_currency_code`,
  `order_status`,
  `marketplace_id`,
  `order_total_number_of_items_shipped`,
  `order_total_number_of_items_unshipped`,
  `count_promotions_used`
  --`item_name`,
  --`display_name`,
  --`brand`,
  --`color`,
  --`size`,
  --`style`,
  --`product_type`,
  --`package_quantity`,
  --`item_classification`
FROM
  `amazon_selling_partner_amazon_selling_partner.amazon_selling_partner__order_items`;
