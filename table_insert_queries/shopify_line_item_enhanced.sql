--NOT IN BIGQUERY--

TRUNCATE TABLE `sheets_base_schema.shopify_line_item_enhanced`;

INSERT INTO `sheets_base_schema.shopify_line_item_enhanced` (
  `header_id`,
  `line_item_id`,
  `line_item_index`,
  `record_type`,
  `created_at`,
  `currency`,
  `header_status`,
  `product_id`,
  `product_name`,
  `transaction_type`,
  `billing_type`,
  `product_type`,
  `quantity`,
  `unit_amount`,
  `discount_amount`,
  `tax_amount`,
  `total_amount`,
  `payment_id`,
  `payment_method_id`,
  `payment_method`,
  `payment_at`,
  `fee_amount`,
  `refund_amount`,
  `subscription_id`,
  `subscription_plan`,
  `subscription_period_started_at`,
  `subscription_period_ended_at`,
  `subscription_status`,
  `customer_id`,
  `customer_created_at`,
  `customer_level`,
  `customer_name`,
  `customer_company`,
  `customer_email`,
  `customer_city`,
  `customer_country`,
  `source_relation`
)
SELECT
  `header_id`,
  `line_item_id`,
  `line_item_index`,
  `record_type`,
  `created_at`,
  `currency`,
  `header_status`,
  `product_id`,
  `product_name`,
  `transaction_type`,
  `billing_type`,
  `product_type`,
  `quantity`,
  `unit_amount`,
  `discount_amount`,
  `tax_amount`,
  `total_amount`,
  `payment_id`,
  `payment_method_id`,
  `payment_method`,
  `payment_at`,
  `fee_amount`,
  `refund_amount`,
  `subscription_id`,
  `subscription_plan`,
  `subscription_period_started_at`,
  `subscription_period_ended_at`,
  `subscription_status`,
  `customer_id`,
  `customer_created_at`,
  `customer_level`,
  `customer_name`,
  `customer_company`,
  `customer_email`,
  `customer_city`,
  `customer_country`,
  `source_relation`
FROM
  `shopify_shopify.shopify__line_item_enhanced`; 