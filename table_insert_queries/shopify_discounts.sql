TRUNCATE TABLE `sheets_base_schema.shopify_discounts`;

INSERT INTO `sheets_base_schema.shopify_discounts` (
  `discount_code_id`,
  `code`,
  `price_rule_id`,
  `usage_count`,
  `created_at`,
  `updated_at`,
  `_fivetran_synced`,
  `source_relation`,
  `discounts_unique_key`,
  `target_selection`,
  `target_type`,
  `title`,
  `usage_limit`,
  `value`,
  `value_type`,
  `allocation_limit`,
  `allocation_method`,
  `is_once_per_customer`,
  `customer_selection`,
  `prereq_min_quantity`,
  `prereq_max_shipping_price`,
  `prereq_min_subtotal`,
  `prereq_min_purchase_quantity_for_entitlement`,
  `prereq_buy_x_get_this`,
  `prereq_buy_this_get_y`,
  `starts_at`,
  `ends_at`,
  `price_rule_created_at`,
  `price_rule_updated_at`,
  `count_orders`,
  `avg_order_discount_amount`,
  `total_order_discount_amount`,
  `total_order_line_items_price`,
  `total_order_shipping_cost`,
  `total_order_refund_amount`,
  `count_customers`,
  `count_customer_emails`,
  `total_abandoned_checkout_discount_amount`,
  `total_abandoned_checkout_shipping_price`,
  `count_abandoned_checkouts`,
  `count_abandoned_checkout_customers`,
  `count_abandoned_checkout_customer_emails`
)
SELECT
  discount_code_id,
  code,
  price_rule_id,
  usage_count,
  created_at,
  updated_at,
  _fivetran_synced,
  source_relation,
  discounts_unique_key,
  target_selection,
  target_type,
  title,
  usage_limit,
  value,
  value_type,
  allocation_limit,
  allocation_method,
  is_once_per_customer,
  customer_selection,
  prereq_min_quantity,
  prereq_max_shipping_price,
  prereq_min_subtotal,
  prereq_min_purchase_quantity_for_entitlement,
  prereq_buy_x_get_this,
  prereq_buy_this_get_y,
  starts_at,
  ends_at,
  price_rule_created_at,
  price_rule_updated_at,
  count_orders,
  avg_order_discount_amount,
  total_order_discount_amount,
  total_order_line_items_price,
  total_order_shipping_cost,
  total_order_refund_amount,
  count_customers,
  count_customer_emails,
  total_abandoned_checkout_discount_amount,
  total_abandoned_checkout_shipping_price,
  count_abandoned_checkouts,
  count_abandoned_checkout_customers,
  count_abandoned_checkout_customer_emails
FROM
  `shopify_shopify.shopify__discounts`;
