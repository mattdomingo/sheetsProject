TRUNCATE TABLE `sheets_base_schema.shopify_customers`;

INSERT INTO `sheets_base_schema.shopify_customers` (
  `customer_id`,
  `email`,
  `first_name`,
  `last_name`,
  `default_address_id`,
  `phone`,
  `account_state`,
  `is_tax_exempt`,
  `is_verified_email`,
  `note`,
  `currency`,
  `marketing_consent_state`,
  `marketing_opt_in_level`,
  `marketing_consent_updated_at`,
  `created_timestamp`,
  `updated_timestamp`,
  `_fivetran_synced`,
  `source_relation`,
  `lifetime_abandoned_checkouts`,
  `first_order_timestamp`,
  `most_recent_order_timestamp`,
  `customer_tags`,
  `avg_order_value`,
  `lifetime_total_spent`,
  `lifetime_total_refunded`,
  `lifetime_total_net`,
  `lifetime_count_orders`,
  `avg_quantity_per_order`,
  `lifetime_total_tax`,
  `avg_tax_per_order`,
  `lifetime_total_discount`,
  `avg_discount_per_order`,
  `lifetime_total_shipping`,
  `avg_shipping_per_order`,
  `lifetime_total_shipping_with_discounts`,
  `avg_shipping_with_discounts_per_order`,
  `lifetime_total_shipping_tax`,
  `avg_shipping_tax_per_order`
)
SELECT
  `customer_id`,
  `email`,
  `first_name`,
  `last_name`,
  `default_address_id`,
  `phone`,
  `account_state`,
  `is_tax_exempt`,
  `is_verified_email`,
  `note`,
  `currency`,
  `marketing_consent_state`,
  `marketing_opt_in_level`,
  `marketing_consent_updated_at`,
  `created_timestamp`,
  `updated_timestamp`,
  `_fivetran_synced`,
  `source_relation`,
  `lifetime_abandoned_checkouts`,
  `first_order_timestamp`,
  `most_recent_order_timestamp`,
  `customer_tags`,
  `avg_order_value`,
  `lifetime_total_spent`,
  `lifetime_total_refunded`,
  `lifetime_total_net`,
  `lifetime_count_orders`,
  `avg_quantity_per_order`,
  `lifetime_total_tax`,
  `avg_tax_per_order`,
  `lifetime_total_discount`,
  `avg_discount_per_order`,
  `lifetime_total_shipping`,
  `avg_shipping_per_order`,
  `lifetime_total_shipping_with_discounts`,
  `avg_shipping_with_discounts_per_order`,
  `lifetime_total_shipping_tax`,
  `avg_shipping_tax_per_order`
FROM
  `shopify_shopify.shopify__customers`; 