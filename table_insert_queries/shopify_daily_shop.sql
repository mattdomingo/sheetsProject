TRUNCATE TABLE `sheets_base_schema.shopify_daily_shop`;

INSERT INTO `sheets_base_schema.shopify_daily_shop` (
  `date_day`,
  `shop_id`,
  `name`,
  `domain`,
  `is_deleted`,
  `currency`,
  `enabled_presentment_currencies`,
  `iana_timezone`,
  `created_at`,
  `source_relation`,
  `count_orders`,
  `count_line_items`,
  `avg_line_item_count`,
  `count_customers`,
  `count_customer_emails`,
  `order_adjusted_total`,
  `avg_order_value`,
  `shipping_cost`,
  `order_adjustment_amount`,
  `order_adjustment_tax_amount`,
  `refund_subtotal`,
  `refund_total_tax`,
  `total_discounts`,
  `avg_discount`,
  `shipping_discount_amount`,
  `avg_shipping_discount_amount`,
  `percentage_calc_discount_amount`,
  `avg_percentage_calc_discount_amount`,
  `fixed_amount_discount_amount`,
  `avg_fixed_amount_discount_amount`,
  `count_discount_codes_applied`,
  `count_locations_ordered_from`,
  `count_orders_with_discounts`,
  `count_orders_with_refunds`,
  `first_order_timestamp`,
  `last_order_timestamp`,
  `quantity_sold`,
  `quantity_refunded`,
  `quantity_net`,
  `avg_quantity_sold`,
  `avg_quantity_net`,
  `count_variants_sold`,
  `count_products_sold`,
  `quantity_gift_cards_sold`,
  `quantity_requiring_shipping`,
  `count_abandoned_checkouts`,
  `count_customers_abandoned_checkout`,
  `count_customer_emails_abandoned_checkout`
  ---`count_fulfillment_attempted_delivery`,
  ---`count_fulfillment_delayed`,
  ---`count_fulfillment_delivered`,
  ---`count_fulfillment_failure`,
  ---`count_fulfillment_in_transit`,
  ---`count_fulfillment_out_for_delivery`,
  ---`count_fulfillment_ready_for_pickup`,
  ---`count_fulfillment_picked_up`,
  ---`count_fulfillment_label_printed`,
  ---`count_fulfillment_label_purchased`,
  ---`count_fulfillment_confirmed`
)
SELECT
  `date_day`,
  `shop_id`,
  `name`,
  `domain`,
  `is_deleted`,
  `currency`,
  `enabled_presentment_currencies`,
  `iana_timezone`,
  `created_at`,
  `source_relation`,
  `count_orders`,
  `count_line_items`,
  `avg_line_item_count`,
  `count_customers`,
  `count_customer_emails`,
  `order_adjusted_total`,
  `avg_order_value`,
  `shipping_cost`,
  `order_adjustment_amount`,
  `order_adjustment_tax_amount`,
  `refund_subtotal`,
  `refund_total_tax`,
  `total_discounts`,
  `avg_discount`,
  `shipping_discount_amount`,
  `avg_shipping_discount_amount`,
  `percentage_calc_discount_amount`,
  `avg_percentage_calc_discount_amount`,
  `fixed_amount_discount_amount`,
  `avg_fixed_amount_discount_amount`,
  `count_discount_codes_applied`,
  `count_locations_ordered_from`,
  `count_orders_with_discounts`,
  `count_orders_with_refunds`,
  `first_order_timestamp`,
  `last_order_timestamp`,
  `quantity_sold`,
  `quantity_refunded`,
  `quantity_net`,
  `avg_quantity_sold`,
  `avg_quantity_net`,
  `count_variants_sold`,
  `count_products_sold`,
  `quantity_gift_cards_sold`,
  `quantity_requiring_shipping`,
  `count_abandoned_checkouts`,
  `count_customers_abandoned_checkout`,
  `count_customer_emails_abandoned_checkout`,
  ---`count_fulfillment_attempted_delivery`,
  ---`count_fulfillment_delayed`,
  ---`count_fulfillment_delivered`,
  ---`count_fulfillment_failure`,
  ---`count_fulfillment_in_transit`,
  ---`count_fulfillment_out_for_delivery`,
  ---`count_fulfillment_ready_for_pickup`,
  ---`count_fulfillment_picked_up`,
  ---`count_fulfillment_label_printed`,
  ---`count_fulfillment_label_purchased`,
  ---`count_fulfillment_confirmed`
FROM
  `shopify_shopify.shopify__daily_shop`; 