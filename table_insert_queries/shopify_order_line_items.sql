-- ----------------------------------------------------------------------------
-- Script to load data from source to target order lines table
-- ----------------------------------------------------------------------------

-- Clear the target table before inserting new data
TRUNCATE TABLE `sheets_base_schema.shopify_order_lines`;

-- Insert data from the source table into the target table
-- Assumes a 1:1 mapping for all columns defined in the CREATE TABLE statement
INSERT INTO `sheets_base_schema.shopify_order_lines` (
  `order_line_id`,
  `index`,
  `name`,
  `order_id`,
  `fulfillable_quantity`,
  `fulfillment_status`,
  `is_gift_card`,
  `grams`,
  `pre_tax_price`,
  `pre_tax_price_set`,
  `price`,
  `price_set`,
  `product_id`,
  `quantity`,
  `is_shipping_required`,
  `sku`,
  `is_taxable`,
  `tax_code`,
  `title`,
  `total_discount`,
  `total_discount_set`,
  `variant_id`,
  `variant_title`,
  `variant_inventory_management`,
  `vendor`,
  `properties`,
  `_fivetran_synced`,
  `source_relation`,
  `order_lines_unique_key`,
  `restock_types`,
  `refunded_quantity`,
  `refunded_subtotal`,
  `quantity_net_refunds`,
  `subtotal_net_refunds`,
  `variant_created_at`,
  `variant_updated_at`,
  `inventory_item_id`,
  `image_id`,
  `variant_price`,
  `variant_sku`,
  `variant_position`,
  `variant_inventory_policy`,
  `variant_compare_at_price`,
  `variant_fulfillment_service`,
  `variant_is_taxable`,
  `variant_barcode`,
  `variant_grams`,
  `variant_inventory_quantity`,
  `variant_weight`,
  `variant_weight_unit`,
  `variant_option_1`,
  `variant_option_2`,
  `variant_option_3`,
  `variant_tax_code`,
  `variant_is_available_for_sale`,
  `variant_display_name`,
  `variant_legacy_resource_id`,
  `variant_has_components_required`,
  `variant_sellable_online_quantity`,
  `order_line_tax`
)
SELECT
  `order_line_id`,
  `index`,
  `name`,
  `order_id`,
  `fulfillable_quantity`,
  `fulfillment_status`,
  `is_gift_card`,
  `grams`,
  `pre_tax_price`,
  `pre_tax_price_set`,
  `price`,
  `price_set`,
  `product_id`,
  `quantity`,
  `is_shipping_required`,
  `sku`,
  `is_taxable`,
  `tax_code`,
  `title`,
  `total_discount`,
  `total_discount_set`,
  `variant_id`,
  `variant_title`,
  `variant_inventory_management`,
  `vendor`,
  `properties`,
  `_fivetran_synced`,
  `source_relation`,
  `order_lines_unique_key`,
  `restock_types`,
  `refunded_quantity`,
  `refunded_subtotal`,
  `quantity_net_refunds`,
  `subtotal_net_refunds`,
  `variant_created_at`,
  `variant_updated_at`,
  `inventory_item_id`,
  `image_id`,
  `variant_price`,
  `variant_sku`,
  `variant_position`,
  `variant_inventory_policy`,
  `variant_compare_at_price`,
  `variant_fulfillment_service`,
  `variant_is_taxable`,
  `variant_barcode`,
  `variant_grams`,
  `variant_inventory_quantity`,
  `variant_weight`,
  `variant_weight_unit`,
  `variant_option_1`,
  `variant_option_2`,
  `variant_option_3`,
  `variant_tax_code`,
  `variant_is_available_for_sale`,
  `variant_display_name`,
  `variant_legacy_resource_id`,
  `variant_has_components_required`,
  `variant_sellable_online_quantity`,
  `order_line_tax`
FROM
  `shopify_shopify.shopify__order_lines`;
